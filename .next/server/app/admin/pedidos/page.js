(()=>{var e={};e.id=713,e.ids=[713],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},4577:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},2086:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>o,routeModule:()=>p,tree:()=>l});var s=r(7096),a=r(6132),i=r(7284),n=r.n(i),c=r(2564),d={};for(let e in c)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>c[e]);r.d(t,d);let l=["",{children:["admin",{children:["pedidos",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,933)),"/projetos/cardapio/src/app/admin/pedidos/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,9862)),"/projetos/cardapio/src/app/admin/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,2594)),"/projetos/cardapio/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9291,23)),"next/dist/client/components/not-found-error"]}],o=["/projetos/cardapio/src/app/admin/pedidos/page.tsx"],m="/admin/pedidos/page",x={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/pedidos/page",pathname:"/admin/pedidos",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},2774:(e,t,r)=>{Promise.resolve().then(r.bind(r,9700))},9700:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var s=r(3854),a=r(4218),i=r(9184),n=r(8504),c=r(5256);function d(){let[e,t]=(0,a.useState)([]),[r,d]=(0,a.useState)(null),[l,o]=(0,a.useState)(!0),[m,x]=(0,a.useState)(!1);(0,a.useEffect)(()=>{p();let e=i.OQ.channel("public:orders").on("postgres_changes",{event:"*",schema:"public",table:"orders"},()=>{p()}).subscribe();return()=>{e.unsubscribe()}},[]);let p=async()=>{try{o(!0);let{data:e,error:r}=await i.OQ.from("orders").select("*").order("created_at",{ascending:!1});if(r)throw r;let s=[];if(e){for(let t of e){let{data:e,error:r}=await i.OQ.from("order_items").select(`
              id,
              quantity,
              unit_price,
              variation_name,
              extras_info,
              products (id, name)
            `).eq("order_id",t.id);if(r)throw r;let a=e?.map(e=>({id:e.id,product_name:e.products.name,quantity:e.quantity,unit_price:e.unit_price,variation_name:e.variation_name||void 0,extras_info:e.extras_info||void 0}))||[];s.push({...t,items:a})}t(s)}}catch(e){console.error("Erro ao buscar pedidos:",e),c.ZP.error("Erro ao carregar os pedidos")}finally{o(!1)}},u=async(e,t)=>{try{let{error:r}=await i.OQ.from("orders").update({status:t,updated_at:new Date().toISOString()}).eq("id",e);if(r)throw r;c.ZP.success(`Status atualizado para: ${t}`)}catch(e){console.error("Erro ao atualizar status:",e),c.ZP.error(e.message||"Erro ao atualizar status")}},h=e=>{d(e),x(!0)};return(0,s.jsxs)("div",{children:[s.jsx("div",{className:"flex justify-between items-center mb-6",children:s.jsx("h1",{className:"text-3xl font-bold",children:"Pedidos"})}),l?s.jsx("div",{className:"flex justify-center",children:s.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-primary rounded-full border-t-transparent"})}):0===e.length?s.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 text-center",children:s.jsx("p",{className:"text-gray-500 mb-4",children:"Nenhum pedido encontrado"})}):s.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-left",children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{className:"bg-gray-50 border-b",children:[s.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),s.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valor"}),s.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data"}),s.jsx("th",{className:"px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"A\xe7\xf5es"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:e.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsx("div",{className:"font-medium",children:e.customer_name}),s.jsx("div",{className:"text-sm text-gray-500",children:e.customer_phone})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-medium",children:(0,n.xG)(e.total)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("select",{value:e.status,onChange:t=>u(e.id,t.target.value),className:"px-2 py-1 border border-gray-300 rounded text-sm",children:[s.jsx("option",{value:"pendente",children:"Pendente"}),s.jsx("option",{value:"confirmado",children:"Confirmado"}),s.jsx("option",{value:"em_preparo",children:"Em Preparo"}),s.jsx("option",{value:"a_caminho",children:"A caminho"}),s.jsx("option",{value:"entregue",children:"Entregue"}),s.jsx("option",{value:"cancelado",children:"Cancelado"})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.created_at).toLocaleString("pt-BR")}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:s.jsx("button",{onClick:()=>h(e),className:"text-blue-600 hover:text-blue-900",children:"Detalhes"})})]},e.id))})]})})}),m&&r&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:s.jsx("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h2",{className:"text-xl font-bold",children:"Detalhes do Pedido"}),(0,s.jsxs)("button",{onClick:()=>x(!1),className:"text-gray-500 hover:text-gray-800",children:[s.jsx("span",{className:"sr-only",children:"Fechar"}),s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Cliente"}),s.jsx("p",{className:"font-medium",children:r.customer_name})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Telefone"}),s.jsx("p",{className:"font-medium",children:r.customer_phone})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Data"}),s.jsx("p",{className:"font-medium",children:new Date(r.created_at).toLocaleString("pt-BR")})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Status"}),s.jsx("p",{className:"font-medium capitalize",children:r.status})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-lg font-medium mb-2",children:"Itens do Pedido"}),s.jsx("div",{className:"border rounded-lg overflow-hidden",children:(0,s.jsxs)("table",{className:"w-full text-left",children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{className:"bg-gray-50 border-b",children:[s.jsx("th",{className:"px-4 py-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Produto"}),s.jsx("th",{className:"px-4 py-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Qtd"}),s.jsx("th",{className:"px-4 py-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pre\xe7o Unit."}),s.jsx("th",{className:"px-4 py-2 text-xs font-medium text-gray-500 uppercase tracking-wider text-right",children:"Subtotal"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:r.items.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsxs)("td",{className:"px-4 py-2",children:[s.jsx("div",{className:"font-medium",children:e.product_name}),e.variation_name&&(0,s.jsxs)("div",{className:"text-xs text-gray-600 mt-1",children:[s.jsx("span",{className:"font-medium",children:"Varia\xe7\xe3o:"})," ",e.variation_name]}),e.extras_info&&(0,s.jsxs)("div",{className:"text-xs text-gray-600 mt-1",children:[s.jsx("span",{className:"font-medium",children:"Adicionais:"})," ",e.extras_info]})]}),s.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:e.quantity}),s.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:(0,n.xG)(e.unit_price)}),s.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-right",children:(0,n.xG)(e.quantity*e.unit_price)})]},e.id))}),s.jsx("tfoot",{children:(0,s.jsxs)("tr",{className:"bg-gray-50",children:[s.jsx("td",{colSpan:3,className:"px-4 py-2 text-right font-bold",children:"Total:"}),s.jsx("td",{className:"px-4 py-2 text-right font-bold",children:(0,n.xG)(r.total)})]})})]})})]}),(0,s.jsxs)("div",{className:"mt-6 flex justify-end space-x-2",children:[s.jsx("button",{onClick:()=>{u(r.id,"entregue"),x(!1)},className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Marcar como Entregue"}),s.jsx("button",{onClick:()=>x(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300",children:"Fechar"})]})]})})})]})}},8504:(e,t,r)=>{"use strict";r.d(t,{Ix:()=>c,WF:()=>a,aF:()=>n,xG:()=>i});var s=r(9184);let a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFHGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDYgNzkuMTY0NzUzLCAyMDIxLzAyLzE1LTExOjUyOjEzICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjIuMyAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMjEtMDQtMTlUMTM6Mzc6MTQrMDE6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDIxLTA0LTE5VDEzOjM4OjQyKzAxOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIxLTA0LTE5VDEzOjM4OjQyKzAxOjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOmM5ZDZlODQxLWIyYjYtNGIxYS1hYjQ2LTBhNjU5ZGIxYmY5OSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpjOWQ2ZTg0MS1iMmI2LTRiMWEtYWI0Ni0wYTY1OWRiMWJmOTkiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpjOWQ2ZTg0MS1iMmI2LTRiMWEtYWI0Ni0wYTY1OWRiMWJmOTkiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmM5ZDZlODQxLWIyYjYtNGIxYS1hYjQ2LTBhNjU5ZGIxYmY5OSIgc3RFdnQ6d2hlbj0iMjAyMS0wNC0xOVQxMzozNzoxNCswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIyLjMgKE1hY2ludG9zaCkiLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+f+lkGAAAALRJREFUeJzt0cENwDAIADFE0/0H6yhkgHug57OzKmk7M9sB3LXeCeyZkDgmJI4JiWNC4piQOCYkjgmJY0LimJA4JiSOCYljQuKYkDgmJI4JiWNC4piQOCYkjgmJY0LimJA4JiSOCYljQuKYkDgmJI4JiWNC4piQOCYkjgmJY0LimJA4JiSOCYljQuKYkDgmJI4JiWNC4piQOCYkjgmJY0LimJA4JiSOCYljQuKYkDg/nxMKXAp7CKEAAAAASUVORK5CYII=";function i(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}function n(e,t){return e.length<=t?e:e.slice(0,t)+"..."}async function c(e,t,r){try{let a=`${Date.now()}_${e.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/--+/g,"-").trim()}`,i=r?`${r}/${a}`:a,{data:n,error:c}=await s.OQ.storage.from(t).upload(i,e,{cacheControl:"3600",upsert:!1});if(c)throw c;let{data:d}=s.OQ.storage.from(t).getPublicUrl(i);return d.publicUrl}catch(e){return console.error("Erro ao fazer upload da imagem:",e),console.warn("Usando imagem placeholder como fallback"),a}}},933:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>n,__esModule:()=>i,default:()=>d});var s=r(5153);let a=(0,s.createProxy)(String.raw`/projetos/cardapio/src/app/admin/pedidos/page.tsx`),{__esModule:i,$$typeof:n}=a,c=a.default,d=c}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[271,840,548,45,308],()=>r(2086));module.exports=s})();