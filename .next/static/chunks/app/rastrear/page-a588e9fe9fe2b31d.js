(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[905],{7465:function(e,t,s){Promise.resolve().then(s.bind(s,259))},259:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var r=s(7437),n=s(2265),a=s(3082),o=s(1396),l=s.n(o),i=s(5925);function d(){let e=(0,a.createClientComponentClient)(),[t,s]=(0,n.useState)(""),[o,d]=(0,n.useState)(""),[c,m]=(0,n.useState)(null),[x,h]=(0,n.useState)(!1),[p,u]=(0,n.useState)(!1),g=e=>{let t=e.replace(/\D/g,"");return t.length<=2?"(".concat(t):t.length<=6?"(".concat(t.slice(0,2),") ").concat(t.slice(2)):t.length<=10?"(".concat(t.slice(0,2),") ").concat(t.slice(2,6),"-").concat(t.slice(6)):"(".concat(t.slice(0,2),") ").concat(t.slice(2,7),"-").concat(t.slice(7,11))},j=e=>{let t=e.replace(/\D/g,"");return t.startsWith("0")?t.substring(1):t},f=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),w=async s=>{if(s.preventDefault(),!t||!o){i.Am.error("Por favor, informe o telefone e o n\xfamero do pedido");return}h(!0),u(!1),m(null);try{let s=j(t),r=o.replace("#","").trim().toLowerCase();console.log("Tentando rastrear - Telefone:",s,"Pedido:",r);let{data:n,error:a}=await e.from("orders").select("\n          id,\n          status,\n          created_at,\n          total,\n          delivery_address,\n          payment_method,\n          customer_name,\n          customer_phone,\n          observations,\n          items:order_items(\n            id,\n            product_name,\n            quantity,\n            unit_price\n          )\n        ").eq("customer_phone",s);console.log("Pedidos encontrados:",(null==n?void 0:n.length)||0,"Telefone:",s),n&&n.forEach(e=>{console.log("Pedido ID: ".concat(e.id,", Status: ").concat(e.status))});let l=(null==n?void 0:n.filter(e=>{let t=e.id.toLowerCase().split("-"),s=t[0],n=s.includes(r)||r.includes(s);return console.log("Comparando: '".concat(s,"' com '").concat(r,"': ").concat(n?"CORRESPONDE":"N\xc3O CORRESPONDE")),n}))||[];if(a||!l||0===l.length){console.error("Pedido n\xe3o encontrado:",r,"para o telefone:",s),console.log("Pedidos dispon\xedveis para este telefone:",n),u(!0),i.Am.error("Pedido n\xe3o encontrado. Verifique o n\xfamero do pedido e telefone.");return}let d=l[0],c=e=>({pendente:"pending",confirmado:"confirmed",em_preparo:"preparing",pronto:"ready",a_caminho:"delivering",entregue:"completed",cancelado:"canceled"})[e]||e;m({id:parseInt(d.id.split("-")[0],16)||0,order_number:d.id.split("-")[0],status:c(d.status),created_at:d.created_at,total:parseFloat(d.total),items:d.items||[],address:d.delivery_address,payment_method:d.payment_method}),console.log("Pedido encontrado e mapeado:",{id:d.id,status:d.status,statusMapeado:c(d.status),telefone:d.customer_phone})}catch(e){console.error("Erro ao rastrear pedido:",e),i.Am.error("Ocorreu um erro ao buscar o pedido. Tente novamente.")}finally{h(!1)}};return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[(0,r.jsx)("header",{className:"bg-white shadow-sm",children:(0,r.jsx)("div",{className:"container mx-auto px-4 py-3 flex items-center",children:(0,r.jsxs)(l(),{href:"/",className:"flex items-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),(0,r.jsx)("span",{className:"font-medium",children:"Voltar ao Card\xe1pio"})]})})}),(0,r.jsx)("main",{className:"flex-1 container mx-auto px-4 py-8 max-w-lg",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,r.jsxs)("div",{className:"bg-primary text-white px-6 py-4",children:[(0,r.jsx)("h1",{className:"text-xl font-bold",children:"Rastrear Pedido"}),(0,r.jsx)("p",{className:"text-primary-50",children:"Acompanhe o status do seu pedido"})]}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefone usado no pedido"}),(0,r.jsx)("input",{id:"phone",type:"text",value:t,onChange:e=>s(g(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary",placeholder:"(00) 00000-0000",maxLength:15})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"orderNumber",className:"block text-sm font-medium text-gray-700 mb-1",children:"N\xfamero do Pedido"}),(0,r.jsx)("input",{id:"orderNumber",type:"text",value:o,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary",placeholder:"Exemplo: ORD123456"})]}),(0,r.jsx)("button",{type:"submit",disabled:x,className:"w-full bg-primary hover:bg-primary-dark text-white font-medium py-2 px-4 rounded-md shadow-sm disabled:opacity-70 flex justify-center items-center",children:x?(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Buscando..."]}):(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Rastrear Pedido"]})})]}),p&&(0,r.jsx)("div",{className:"mt-6 bg-red-50 border-l-4 border-red-500 p-4",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsx)("p",{className:"text-sm text-red-700",children:"Pedido n\xe3o encontrado. Verifique se o n\xfamero do pedido e o telefone est\xe3o corretos."})})]})}),c&&(0,r.jsxs)("div",{className:"mt-6 border-t pt-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-lg font-bold text-gray-900",children:["Pedido #",c.order_number]}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["Realizado em ",(e=>{let t=new Date(e);return t.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})(c.created_at)]})]}),(0,r.jsx)("div",{children:(e=>{switch(e){case"pending":return(0,r.jsxs)("div",{className:"flex items-center text-orange-500",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsx)("span",{children:"Aguardando Confirma\xe7\xe3o"})]});case"confirmed":return(0,r.jsxs)("div",{className:"flex items-center text-blue-500",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsx)("span",{children:"Pedido Confirmado"})]});case"preparing":return(0,r.jsxs)("div",{className:"flex items-center text-blue-600",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsx)("span",{children:"Em Prepara\xe7\xe3o"})]});case"ready":return(0,r.jsxs)("div",{className:"flex items-center text-green-500",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsx)("span",{children:"Pronto para Entrega"})]});case"delivering":return(0,r.jsxs)("div",{className:"flex items-center text-purple-500",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0m-4 0a2 2 0 114 0m6 0a2 2 0 104 0m-4 0a2 2 0 114 0"})}),(0,r.jsx)("span",{children:"Em Rota de Entrega"})]});case"completed":return(0,r.jsxs)("div",{className:"flex items-center text-green-600",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsx)("span",{children:"Pedido Entregue"})]});case"canceled":return(0,r.jsxs)("div",{className:"flex items-center text-red-500",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsx)("span",{children:"Pedido Cancelado"})]});default:return(0,r.jsxs)("div",{className:"flex items-center text-gray-500",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsx)("span",{children:"Status Desconhecido"})]})}})(c.status)})]}),(e=>{let t=[{key:"pending",label:"Recebido"},{key:"confirmed",label:"Confirmado"},{key:"preparing",label:"Preparando"},{key:"ready",label:"Pronto"},{key:"delivering",label:"Em Entrega"},{key:"completed",label:"Entregue"}],s=t.findIndex(t=>t.key===e),n="canceled"===e;return n?(0,r.jsx)("div",{className:"mt-6 flex justify-center",children:(0,r.jsxs)("div",{className:"inline-flex items-center px-4 py-2 rounded-full bg-red-100 text-red-800",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Pedido Cancelado"]})}):(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsx)("div",{className:"flex justify-between items-center",children:t.map((e,t)=>(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center ".concat(t<=s?"bg-green-500 text-white":"bg-gray-200 text-gray-400"),children:t<=s?(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):(0,r.jsx)("span",{className:"text-xs",children:t+1})}),(0,r.jsx)("span",{className:"text-xs mt-1 ".concat(t<=s?"text-green-500 font-medium":"text-gray-400"),children:e.label})]},e.key))}),(0,r.jsx)("div",{className:"relative h-1 bg-gray-200 mt-3",children:(0,r.jsx)("div",{className:"absolute top-0 left-0 h-full bg-green-500 transition-all duration-500",style:{width:n?"0%":"".concat(Math.min(100,s/(t.length-1)*100),"%")}})})]})})(c.status),(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Detalhes do Pedido"}),(0,r.jsx)("div",{className:"border rounded-md overflow-hidden",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Item"}),(0,r.jsx)("th",{scope:"col",className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Qtd"}),(0,r.jsx)("th",{scope:"col",className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pre\xe7o"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:c.items.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:e.product_name}),(0,r.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900 text-center",children:e.quantity}),(0,r.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900 text-right",children:f(e.unit_price*e.quantity)})]},e.id))}),(0,r.jsxs)("tfoot",{className:"bg-gray-50",children:[void 0!==c.delivery_fee&&c.delivery_fee>0&&(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{colSpan:2,className:"px-4 py-2 text-sm text-gray-700 text-right font-medium",children:"Taxa de entrega:"}),(0,r.jsx)("td",{className:"px-4 py-2 text-sm text-gray-900 text-right",children:f(c.delivery_fee||0)})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{colSpan:2,className:"px-4 py-2 text-sm font-bold text-gray-900 text-right",children:"Total:"}),(0,r.jsx)("td",{className:"px-4 py-2 text-sm font-bold text-gray-900 text-right",children:f(c.total)})]})]})]})})]}),c.address&&(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Endere\xe7o de Entrega"}),(0,r.jsx)("p",{className:"text-sm text-gray-700 p-3 bg-gray-50 rounded-md",children:c.address})]}),(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"M\xe9todo de Pagamento"}),(0,r.jsx)("p",{className:"text-sm text-gray-700 p-3 bg-gray-50 rounded-md",children:c.payment_method})]})]})]})]})})]})}}},function(e){e.O(0,[36,847,29,971,472,744],function(){return e(e.s=7465)}),_N_E=e.O()}]);